<div class="filter-form-container">
  <form [formGroup]="filterForm" aria-label="Formulaire de filtres de recherche">
  
    <!-- Section Prix -->
    <div class="form-section">
      <div class="section-header">
        <div class="section-title">
          <div class="icon-container">
            <img src="assets/icons/house-plus.png" alt="Prix" class="section-icon-img">
          </div>
          <h3>Ventes passées</h3>
        </div>
        <div class="loading-spinner" *ngIf="priceLoading">
          <div class="spinner"></div>
        </div>
        <img src="assets/icons/down.png" 
             alt="Expand section" 
             class="section-chevron" 
             [class.rotated]="priceExpanded"
             (click)="togglePriceExpanded()">
        <label class="toggle-switch" for="usePriceFilter">
          <input type="checkbox" formControlName="usePriceFilter" id="usePriceFilter">
          <span class="slider"></span>
        </label>
      </div>
  
      <div class="section-content" *ngIf="priceExpanded">
        <div class="radio-group-inline">
          <label class="radio-item">
            <input type="radio" value="exact" formControlName="priceMode" [checked]="filterForm.get('priceMode')?.value === 'exact'">
            <span class="radio-label">Exact</span>
          </label>
          <label class="radio-item">
            <input type="radio" value="range" formControlName="priceMode" [checked]="filterForm.get('priceMode')?.value === 'range'">
            <span class="radio-label">Intervalle</span>
          </label>
        </div>
  
        <div class="price-exact" *ngIf="filterForm.get('priceMode')?.value === 'exact'">
          <div class="form-group">
            <label for="price">Montant (€)</label>
            <input type="number" id="price" formControlName="price" placeholder="ex: 150000">
          </div>
        </div>
  
        <div class="price-interval" *ngIf="filterForm.get('priceMode')?.value === 'range'">
          <div class="input-row-compact">
            <div class="form-group">
              <label for="minPrice">Min (€)</label>
              <input type="number" id="minPrice" formControlName="minPrice" placeholder="100000">
            </div>
            <div class="form-group">
              <label for="maxPrice">Max (€)</label>
              <input type="number" id="maxPrice" formControlName="maxPrice" placeholder="300000">
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Section Surface -->
    <div class="form-section">
      <div class="section-header">
        <div class="section-title">
          <div class="icon-container">
            <img src="assets/icons/m2-icon.png" alt="Taille du terrain" class="section-icon-img">
          </div>
          <h3>Taille du terrain</h3>
        </div>
        <div class="loading-spinner" *ngIf="surfaceLoading">
          <div class="spinner"></div>
        </div>
        <img src="assets/icons/down.png" 
             alt="Expand section" 
             class="section-chevron" 
             [class.rotated]="surfaceExpanded"
             (click)="toggleSurfaceExpanded()">
        <label class="toggle-switch" for="useSurfaceFilter">
          <input type="checkbox" formControlName="useSurfaceFilter" id="useSurfaceFilter">
          <span class="slider"></span>
        </label>
      </div>
  
      <div class="section-content" *ngIf="surfaceExpanded">
        <div class="radio-group-inline">
          <label class="radio-item">
            <input type="radio" value="exact" formControlName="surfaceMode" [checked]="filterForm.get('surfaceMode')?.value === 'exact'">
            <span class="radio-label">Exact</span>
          </label>
          <label class="radio-item">
            <input type="radio" value="range" formControlName="surfaceMode" [checked]="filterForm.get('surfaceMode')?.value === 'range'">
            <span class="radio-label">Intervalle</span>
          </label>
        </div>
  
        <div class="surface-exact" *ngIf="filterForm.get('surfaceMode')?.value === 'exact'">
          <div class="form-group">
            <label for="surface">Surface (m²)</label>
            <input type="number" id="surface" formControlName="surface" placeholder="ex: 150">
          </div>
        </div>
  
        <div class="surface-interval" *ngIf="filterForm.get('surfaceMode')?.value === 'range'">
          <div class="input-row-compact">
            <div class="form-group">
              <label for="minSurface">Min (m²)</label>
              <input type="number" id="minSurface" formControlName="minSurface" placeholder="100">
            </div>
            <div class="form-group">
              <label for="maxSurface">Max (m²)</label>
              <input type="number" id="maxSurface" formControlName="maxSurface" placeholder="1000">
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Section Classe Énergétique -->
    <div class="form-section">
      <div class="section-header">
        <div class="section-title">
          <div class="icon-container">
            <img src="assets/icons/energy-class-icon.png" alt="Classe énergétique" class="section-icon-img">
          </div>
          <h3>Classe énergétique</h3>
        </div>
        <div class="loading-spinner" *ngIf="energyLoading">
          <div class="spinner"></div>
        </div>
        <img src="assets/icons/down.png" 
             alt="Expand section" 
             class="section-chevron" 
             [class.rotated]="energyExpanded"
             (click)="toggleEnergyExpanded()">
        <label class="toggle-switch" for="useEnergyFilter">
          <input type="checkbox" formControlName="useEnergyFilter" id="useEnergyFilter">
          <span class="slider"></span>
        </label>
      </div>
  
      <div class="section-content" *ngIf="energyExpanded">
        <div class="energy-ratings">
          <label class="energy-rating rating-a">
            <input type="checkbox" formControlName="energyClassA">
            <span class="rating-letter">A</span>
          </label>
          <label class="energy-rating rating-b">
            <input type="checkbox" formControlName="energyClassB">
            <span class="rating-letter">B</span>
          </label>
          <label class="energy-rating rating-c">
            <input type="checkbox" formControlName="energyClassC">
            <span class="rating-letter">C</span>
          </label>
          <label class="energy-rating rating-d">
            <input type="checkbox" formControlName="energyClassD">
            <span class="rating-letter">D</span>
          </label>
          <label class="energy-rating rating-e">
            <input type="checkbox" formControlName="energyClassE">
            <span class="rating-letter">E</span>
          </label>
          <label class="energy-rating rating-f">
            <input type="checkbox" formControlName="energyClassF">
            <span class="rating-letter">F</span>
          </label>
          <label class="energy-rating rating-g">
            <input type="checkbox" formControlName="energyClassG">
            <span class="rating-letter">G</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Section Consommation -->
    <div class="form-section">
      <div class="section-header">
        <div class="section-title">
          <div class="icon-container">
            <img src="assets/icons/kwh-icon.png" alt="Consommation" class="section-icon-img">
          </div>
          <h3>Consommation</h3>
        </div>
        <div class="loading-spinner" *ngIf="consumptionLoading">
          <div class="spinner"></div>
        </div>
        <img src="assets/icons/down.png" 
             alt="Expand section" 
             class="section-chevron" 
             [class.rotated]="consumptionExpanded"
             (click)="toggleConsumptionExpanded()">
        <label class="toggle-switch" for="useConsumptionFilter">
          <input type="checkbox" formControlName="useConsumptionFilter" id="useConsumptionFilter">
          <span class="slider"></span>
        </label>
      </div>
  
      <div class="section-content" *ngIf="consumptionExpanded">
        <div class="radio-group-inline">
          <label class="radio-item">
            <input type="radio" value="exact" formControlName="consumptionMode" [checked]="filterForm.get('consumptionMode')?.value === 'exact'">
            <span class="radio-label">Exact</span>
          </label>
          <label class="radio-item">
            <input type="radio" value="range" formControlName="consumptionMode" [checked]="filterForm.get('consumptionMode')?.value === 'range'">
            <span class="radio-label">Intervalle</span>
          </label>
        </div>

        <div class="consumption-exact" *ngIf="filterForm.get('consumptionMode')?.value === 'exact'">
          <div class="form-group">
            <label for="exactConsumption">Consommation (kWh/m²/an)</label>
            <input type="number" id="exactConsumption" formControlName="exactConsumption" placeholder="ex: 150">
          </div>
        </div>

        <div class="consumption-interval" *ngIf="filterForm.get('consumptionMode')?.value === 'range'">
          <div class="input-row-compact">
            <div class="form-group">
              <label for="minConsumption">Min (kWh/m²/an)</label>
              <input type="number" id="minConsumption" formControlName="minConsumption" placeholder="50">
            </div>
            <div class="form-group">
              <label for="maxConsumption">Max (kWh/m²/an)</label>
              <input type="number" id="maxConsumption" formControlName="maxConsumption" placeholder="300">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Section Date with Custom Date Picker -->
    <div class="form-section">
      <div class="section-header">
        <div class="section-title">
          <div class="icon-container">
            <img src="assets/icons/clock-icon.png" alt="Période" class="section-icon-img">
          </div>
          <h3>Période</h3>
        </div>
        <div class="loading-spinner" *ngIf="dateLoading">
          <div class="spinner"></div>
        </div>
        <img src="assets/icons/down.png" 
             alt="Expand section" 
             class="section-chevron" 
             [class.rotated]="dateExpanded"
             (click)="toggleDateExpanded()">
        <label class="toggle-switch" for="useDateFilter">
          <input type="checkbox" formControlName="useDateFilter" id="useDateFilter">
          <span class="slider"></span>
        </label>
      </div>
  
      <div class="section-content" *ngIf="dateExpanded">
        <div class="radio-group-inline">
          <label class="radio-item">
            <input type="radio" value="exact" formControlName="dateMode" [checked]="filterForm.get('dateMode')?.value === 'exact'">
            <span class="radio-label">Exact</span>
          </label>
          <label class="radio-item">
            <input type="radio" value="range" formControlName="dateMode" [checked]="filterForm.get('dateMode')?.value === 'range'">
            <span class="radio-label">Intervalle</span>
          </label>
        </div>
  
        <div class="date-exact" *ngIf="filterForm.get('dateMode')?.value === 'exact'">
          <div class="form-group">
            <label for="exactDate">Date</label>
            <input type="date" id="exactDate" formControlName="exactDate">
          </div>
        </div>
  
        <div class="date-interval" *ngIf="filterForm.get('dateMode')?.value === 'range'">
          <div class="input-row-compact">
            <div class="form-group">
              <label for="startDate">Début</label>
              <input type="date" id="startDate" formControlName="startDate">
            </div>
            <div class="form-group">
              <label for="endDate">Fin</label>
              <input type="date" id="endDate" formControlName="endDate">
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </form>
</div>
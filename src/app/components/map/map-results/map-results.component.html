<!-- Tableau en bas -->
<div class="property-list-container" [class.collapsed]="tableCollapsed">
  <button class="property-list-header" (click)="toggleTable()" [attr.aria-expanded]="!tableCollapsed" aria-controls="property-list-content">
   

    <!-- Navbar pour basculer entre les sources de donn√©es - maintenant au centre -->
    <div class="header-center">
      
        <button 
          class="navbar-tab-inline" 
          [class.active]="selectedDataSource === 'dvf'"
          [class.disabled]="visibleDvfProperties.length === 0"
          (click)="selectDataSource('dvf'); $event.stopPropagation()"
          >
          <span class="tab-icon">üè†</span>
          <span class="tab-label">DVF</span>
          <span class="tab-count">({{visibleDvfProperties.length}})</span>
        </button>
        
        <button 
          class="navbar-tab-inline" 
          [class.active]="selectedDataSource === 'dpe'"
          [class.disabled]="visibleDpeProperties.length === 0"
          (click)="selectDataSource('dpe'); $event.stopPropagation()">
          <span class="tab-icon">‚ö°</span>
          <span class="tab-label">DPE</span>
          <span class="tab-count">({{visibleDpeProperties.length}})</span>
        </button>
        
        <button 
          class="navbar-tab-inline" 
          [class.active]="selectedDataSource === 'parcelles'"
          [class.disabled]="visibleParcelleProperties.length === 0"
          (click)="selectDataSource('parcelles'); $event.stopPropagation()">
          <span class="tab-icon">üìê</span>
          <span class="tab-label">Parcelles</span>
          <span class="tab-count">({{visibleParcelleProperties.length}})</span>
        </button>
      </div>
    

    <div class="header-right">
      <div class="results-actions">
        
        <svg class="toggle-icon" [class.collapsed]="tableCollapsed" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>
  </button>

  <div id="property-list-content" class="property-list" *ngIf="!tableCollapsed">
    <!-- Tableau DVF -->
    <table class="property-table" *ngIf="getSelectedDataSource() === 'dvf' && visibleDvfProperties.length > 0">
      <thead>
        <tr>
         
          <th>ID</th>
          <th>Type Locale</th>
          <th>Adresse</th>
          <th>Prix</th>
          <th>Date</th>
          <th>Commune</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let prop of visibleDvfProperties; let i = index"
            [class.selected]="selectedPropertyIndex === i"
            (click)="selectProperty(i, prop)">
          
          <td>{{ prop.id_mutation }}</td>
          <td>{{ prop.type_local || 'Non sp√©cifi√©' }}</td>
          <td>{{ prop.adresse_nom_voie }}</td>
          <td>{{ prop.valeur_fonciere | number }} ‚Ç¨</td>
          <td>{{ prop.date_mutation }}</td>
          <td>{{ prop.nom_commune }}</td>
        </tr>
      </tbody>
    </table>

    <!-- Tableau DPE -->
    <table class="property-table" *ngIf="getSelectedDataSource() === 'dpe' && visibleDpeProperties.length > 0">
      <thead>
        <tr>
          
          <th>ID</th>
          <th>Adresse</th>
          <th>Classe √©nergie</th>
          <th>Consommation</th>
          <th>Commune</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let prop of visibleDpeProperties; let i = index"
            [class.selected]="selectedPropertyIndex === i"
            (click)="selectProperty(i, prop)">
          
          <td><span class="id-text">{{ prop.id }}</span></td>
          <td>{{ prop.address }}</td>
          <td><span class="energy-rating rating-{{ prop.energyClass.toLowerCase() }}">{{ prop.energyClass }}</span></td>
          <td><span class="consumption-value">{{ prop.ep_conso_5_usages || 'N/A' }} kWh/m¬≤</span></td>
          <td>{{ prop.city }}</td>
        </tr>
      </tbody>
    </table>

    <!-- Tableau Parcelles -->
    <table class="property-table" *ngIf="getSelectedDataSource() === 'parcelles' && visibleParcelleProperties.length > 0">
      <thead>
        <tr>
          
          <th>ID</th>
          <th>Adresse</th>
          <th>Num√©ro</th>
          <th>Surface</th>
          <th>Commune</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let prop of visibleParcelleProperties; let i = index"
            [class.selected]="selectedPropertyIndex === i"
            (click)="selectProperty(i, prop)">
          
          <td><span class="id-text">{{ prop.id }}</span></td>
          <td>{{ prop.address }}</td>
          <td>{{ prop.number }}</td>
          <td>{{ prop.surface | number }} m¬≤</td>
          <td>{{ prop.city }}</td>
        </tr>
      </tbody>
    </table>

    <div class="no-results" *ngIf="getTotalResults() === 0">
      <div class="no-results-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <h3>Aucun r√©sultat trouv√©</h3>
      <p>Veuillez ajuster vos filtres ou effectuer une nouvelle recherche</p>
    </div>
  </div>
</div>